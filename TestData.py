# -*- coding: utf-8 -*-
"""
Created on Thu Nov  9 09:02:46 2023

@author: Fang Xu
"""
import numpy as np
import pandas as pd

date_file_map = {"Sunday":"Jerusalem_Trips_Weekday.csv",
            "Monday":"Jerusalem_Trips_Weekday.csv",
            "Tuesday":"Jerusalem_Trips_Weekday.csv",
            "Wednesday":"Jerusalem_Trips_Weekday.csv",
            "Thursday":"Jerusalem_Trips_Weekday.csv",
            "Friday":"Jerusalem_Trips_Friday.csv",
            "Saturday":"Jerusalem_Trips_Friday.csv"}

passengers_df = pd.read_csv('Data/Passenger_Request_Group.csv')
passenger_list = []
num = 0
for passenger in passengers_df.itertuples():
     num = num + 1
     passenger_disc = {}
     passenger_disc["start_node"] = str(passenger.Departure)
     passenger_disc["goal_node"] = str(passenger.Destination)
     passenger_disc["day"] = passenger.Day
     passenger_disc["time"] = passenger.Time
     passenger_disc["dataset"] = str(num)
     if num != 4:
        continue
     passenger_list.append(passenger_disc)
     print(passenger.Departure,passenger.Destination)
     
         


Jerusalem_grid = np.array([[0, 0, 0, 0, 0, 0, 0, 0, 0, '100506', 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, '100505', 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, '100515', '100507', '100508'],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, '100514', '100598'],
[0, 0, 0, 0, 0, '100523', '100525', '100530','100511', '100510', '100513', '100517'],
[0, 0, 0, 0, 0, '100523', '100525', '100530','100511', '100510', '100513', '100517'],
[0, 0, 0,  '100551', '100553','100531', '100528','100527',0, 0,0, 0],
[0, 0, '100585', '100550', '100548', '100552', '100546','100547', '100529', '100520', '100519',  '100516'],
[0, 0, '100554', '100558', '100549', '100537', '100545','100439',  '100539', '100521', '100668',  '100522'],
[0, '100560', '100561', '100556', '100557', '100543', '100541', '100540', '100544', '100538', '100518',   0],
['100562', '100574', '100555', '101260', '100569', '100542', '101258', '100577', '100576', '100533', '100534', 0],
[0, '100559', '100575', '100573', '100572','100570', '100582', '100793', '100532', 0, 0, 0],
[0, 0, 0, 0, '100799', '100571', '100586','100581', '100584', '100583', 0, 0],
[0, 0, '100566', '100669', '100667', '100587', '100578', '100580', '100535', 0, 0, 0],
[0, 0, 0, '100565', '100564', '100563', '100579', '100536', 0, 0, 0, 0]])



zone_graph1 = {}
zone_graph1["100511"] = ["100527","100530"]
zone_graph1["100530"] = ["100531", "100528"]
zone_graph1["100525"] = ["100523","100531"]
zone_graph1["100523"] = ["100551","100553"]
zone_graph1["100531"] = ["100553", "100547"]
zone_graph1["100553"] = ["100552","100546", "100547"]
zone_graph1["100552"] = ["100548","100546"]
zone_graph1["100547"] = ["100546","100545","100539"]
zone_graph1["100551"] = ["100550","100553"]
zone_graph1["100528"] = ["100547", "100529"]
zone_graph1["100548"] = ['100541',"100537"]
zone_graph1["100546"] = ["100545","100537"]
zone_graph1["100545"] = ["100544"]
zone_graph1["100539"] = ["100439"]
zone_graph1["100550"] = ["100549","100548"]
zone_graph1["100549"] = ["100557","100548"]
zone_graph1["100557"] = ['100541',"100543"]
zone_graph1["100543"] = ["100542"]
zone_graph1["100542"] = ["100540"]
zone_graph1["100544"] = []
zone_graph1["100540"] = ["100544"]
zone_graph1["100529"] = ["100539"]
zone_graph1["100537"] = ["100541","100545"]
zone_graph1["100439"] = ["100544"]
zone_graph1["100541"] = ["100544"]
zone_graph1["100527"] = ["100528","100529","100520","100519"]
zone_graph1["100520"] = ["100529"]
zone_graph1["100519"] = ["100520","100668"]
zone_graph1["100668"] = ["100520","100521"]
zone_graph1["100521"] = ["100539","100439","100538"]
zone_graph1["100538"] = ["100544"]

zone_graph2 = {}
zone_graph2["100543"] = ["100541"]
zone_graph2["100541"] = ["100544","100545"]
zone_graph2["100545"] = ["100439","100539","100547"]
zone_graph2["100542"] = ["100540","101258"]
zone_graph2["100547"] = ["100528","100529"]
zone_graph2["100528"] = ["100527","100529"]
zone_graph2["100540"] = ["100544","100538","100577"]
zone_graph2["101258"] = ["100577","100576"]
zone_graph2["100544"] = ["100439","100538"]
zone_graph2["100538"] = ["100521","100518"]
zone_graph2["100577"] = ["100576","100538"]
zone_graph2["100576"] = ["100532","100518"]
zone_graph2["100439"] = ["100539","100538"]
zone_graph2["100539"] = ["100529"]
zone_graph2["100521"] = ["100520","100529","100668"]
zone_graph2["100518"] = ["100533","100521"]
zone_graph2["100532"] = ["100533","100518"]
zone_graph2["100529"] = ["100520","100527"]
zone_graph2["100533"] = ["100668","100522"]
zone_graph2["100668"] = ["100519"]
zone_graph2["100527"] = ["100519"]
zone_graph2["100522"] = ["100519"]
zone_graph2["100520"] = ["100519"]
zone_graph2["100519"] = []


zone_graph3 = {}
zone_graph3["100570"] = ["100581","100586"]
zone_graph3["100581"] = ["100584","100587"]
zone_graph3["100586"] = ["100669","100667"]
zone_graph3["100584"] = ["100793","100583"]
zone_graph3["100793"] = ["100583"]
zone_graph3["100583"] = ["100578"]
zone_graph3["100587"] = ["100578"]
zone_graph3["100669"] = ["100565","100667"]
zone_graph3["100667"] = ["100564","100587"]
zone_graph3["100565"] = ["100563"]
zone_graph3["100564"] = ["100563"]
zone_graph3["100563"] = ["100579"]
zone_graph3["100579"] = ["100578"]
zone_graph3["100578"] = []


zone_graph4 = {}
zone_graph4["100536"] = ["100580","100535"]
zone_graph4["100580"] = ["100583"]
zone_graph4["100535"] = ["100532","100533","100534"]
zone_graph4["100583"] = ["100793","100532"]
zone_graph4["100532"] = ["100576","100518"]
zone_graph4["100533"] = ["100518","100668"]
zone_graph4["100534"] = ["100522"]
zone_graph4["100793"] = ["100576"]
zone_graph4["100576"] = ["100538","100518"]
zone_graph4["100518"] = ["100521","100668"]
zone_graph4["100668"] = ["100519"]
zone_graph4["100522"] = ["100519"]
zone_graph4["100521"] = ["100520","100668"]
zone_graph4["100520"] = ["100519"]
zone_graph4["100538"] = ["100521"]
zone_graph4["100519"] = []

zone_graph={}
zone_graph["zone_graph1"]=zone_graph1
zone_graph["zone_graph2"]=zone_graph2
zone_graph["zone_graph3"]=zone_graph3
zone_graph["zone_graph4"]=zone_graph4